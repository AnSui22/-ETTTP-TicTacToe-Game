## 23-1 Ewha Womans University Information and Communication Engineering
### -ETTTP-TicTacToe-Game
---
### ✏️소개
1. Server
이 코드를 실행하면 우선 서버는 0 과 1 중에서 랜덤으로 숫자를 골라서 그 숫자에 따라 시작
순서를 결정하여 클라이언트에게 encode() 함수로 인코딩하여 전송한다.
시작 순서가 0 이면 서버가 먼저 시작하는 것을 의미하므로 메시지에 'ME'를 포함하여 서버가
먼저 시작하겠다고 전송한다.
시작 순서가 1 이면 클라이언트가 먼저 시작하는 것을 의미하므로 메시지에 'YOU'를 포함하여
클라이언트가 먼저 시작하도록 메시지를 전송한다.
클라이언트 소켓으로부터 메시지가 알맞은 ETTTP 형식으로 전송되었는지, 올바른 IP 주소를
포함하여 전송되었는지 확인 받고 ACK 메시지를 수신한 후 디코딩한다.
클라이언트로부터 수신한 ACK 메시지가 ETTTP 형식에 맞는지 check_msg 함수를 사용하여
확인한다. 그리고 ETTTP 형식에 맞지 않으면 서버 소켓을 닫고 종료한다.


2. Client
클라이언트 코드를 실행했을 시 클라이언트는 우선 서버가 전송한 start 변수를 받고 first_mover
decision 메시지를 받는다.
서버가 전송한 first_mover decision 메시지가 ETTTP 형식에 맞는 지, 알맞은 IP 주소를 포함했는지
확인하고 ACK 을 보낸다. 메시지가 올바르지 않은 형식으로 왔다면 클라이언트 소켓을 종료한다.

3. TicTacToe
- get_move
: 이 코드는 상대방이 선택한 위치를 메시지로 받아 ETTTP 형식에 맞는지 확인하고 형식에 맞다
면 ACK을 보내고 위치를 저장한다.
상대방으로부터 상대방의 new_move 메시지를 받는다. 받은 메시지에서 peer의 new_move 좌표
만 얻어오기 위해 메시지의 특수문자들을 전부 공백으로 대체하고 파싱하였다. 파싱한 각각의
정보를 리스트에 저장한 후 이 리스트에서 new_move 좌표를 추출하여 move_line에 저장한다.
move_line의 행좌표와 열좌표를 추출하여 각각 저장하고 move_line을 포함한 ack 메시지를 작
성한다. ETTTP 형식에 맞는지 check_msg 함수를 통하여 ETTTP/1.0 이 맞는지, IP 주소가 자신의
IP 주소와 같은지를 확인하고 메시지가 유효한지 아닌지를 판단하여 메시지가 유효하지 않다고
판단되면 소켓을 닫고 종료한다. 메시지가 유효할 경우에는 작성한 ACK을 전송하고 loc 변수에
상대방의 좌표를 0~8의 숫자로 저장한다.

-send_debug
Send_debug 함수는 보드를 클릭하지 않고 사용자로부터 ETTTP 메시지를 직접 입력받아서 메
시지가 알맞은 형식을 따르고 있는지, 입력받은 좌표가 비어있는지 확인한 후 문제가 없다면
peer에게 자신의 new_move에 관한 ETTTP 메시지를 작성하고 ack을 받은 후 보드를 업데이트
하는 함수이다.
Gui 창의 텍스트 박스에 사용자가 작성한 메시지를 d_msg에 저장하고 get_move에서와 같이
d_msg의 특수문자들을 공백으로 대체하고 공백을 기준으로 메시지를 파싱하여 리스트에 저장
한다. 리스트로부터 행좌표와 열좌표를 추출하고 이로부터 user_move의 위치를 0~8의 숫자로
변환해준다. 그 위치가 이미 채워져 있다면 아무것도 실행하지 않고 리턴한다. 위치가 비어 있
다면 peer에게 메시지를 전송하고 peer가 메시지를 확인하고 ack을 보내면 ack이 ETTTP 형식에
맞는지 확인한다. 문제가 없다면 loc에 위치를 저장하고 loc에 따라 보드를 업데이트 해준다

-Send_move
이 함수는 button을 눌렀을 때 peer에게 메시지를 전송하고 peer가 그 메시지를 확인하고 ack
을 보냈을 때 ack을 확인하는 함수이다. divmod를 통하여 selection의 행과 열을 계산하고
ETTTP 메시지에 자신이 선택한 좌표를 포함하여 peer에게 전송한다. Peer가 메시지를 받고 확인
한 뒤 ack을 보내면 ack 메시지가 형식에 맞는지 체크하고 형식에 맞다면 true를 형식에 맞지
않다면 false를 반환한다.

-Check_result
이 코드는 게임이 끝났을 때 server와 client의 결과가 같은 지 확인하여 같으면 True, 틀리면
False를 반환한다.
Get이 False인 경우 이 유저는 승자이므로 자신의 결과를 먼저 상대방에게 소켓을 통해 Winner:
ME를 포함하는 메시지 형태로 전송한다.
상대방은 이 메시지를 받은 후 check_msg 함수를 통해 ETTTP형식이 맞는지 자신의 IP주소와
같은 지 확인하고 맞다면 결과를 비교한다. 만약 맞지 않다면 False를 반환한다. 결과를 비교하
는 과정에서 받은 메시지에서 winner만 얻어오기 위해 메시지의 특수문자들을 전부 공백으로
대체하고 파싱하였다. 파싱한 각각의 정보를 리스트에 저장한 후 이 리스트에서 winner를 추출
하여 peer_result에 저장한다.
Peer_result와 결과가 같다면 자신의 결과를 상대방에게 소켓을 통해 Winner: YOU를 포함하는
메시지 형태로 전송한다.
이 메시지를 받고 check_msg 함수를 통해 ETTTP형식이 맞는지 자신의 IP주소와 같은 지 확인
하고 맞다면 결과를 비교한다. 만약 맞지 않다면 False를 반환한다. 앞 경우와 마찬가지로
Peer_result에 저장하여 결과가 같은 지 확인한다. 결과가 같다면 True를 반환하고 틀리면 False
를 반환한다.

-Check_msg
이 코드는 변수로 받은 msg에서 통신 프로토콜과 IP주소를 추출하여 올바른 ETTTP 형식인지,
추출한 IP주소가 변수로 받은 recv_ip와 같은 지 확인하여 맞다면 True, 틀리면 False를 반환한다.
받은 메시지에서 통신 프로토콜과 IP주소만 얻어오기 위해 메시지의 특수문자들을 전부 공백으
로 대체하고 파싱하였다. 파싱한 각각의 정보를 리스트에 저장한 후 이 리스트에서 통신 프로토
콜과 IP주소를 추출하여 versions와 ip_line에 각각 저장한다.
이 통신 프로토콜이 ETTTP/1.0형식이 맞는 지 확인하고 ip_line이 변수로 받은 recv_ip와 같은
지 확인하여 맞다면 True를 반환하고 틀리면 False를 반환한다.

